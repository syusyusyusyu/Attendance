# プレゼン用Q&A（学内作品展向け）

## 用語注釈（簡易）
- QR: 二次元コード。紙や画面に表示してカメラで読み取るもの。
- QRスキャン: カメラでQRを読み取る操作。
- CSV: 表データをカンマ区切りで保存するテキスト形式。
- Push通知: ブラウザが表示するプッシュ通知。
- LINE通知: LINEの公式API経由で送る通知。
- Hotwire: RailsでリアルタイムUIを実現する仕組み（Turbo+Stimulus）。
- Turbo: 画面遷移や部分更新を高速化する仕組み。
- Stimulus: 画面の動きを制御する軽量なJavaScriptフレームワーク。
- MessageVerifier: Railsの署名機構。改ざん検知に使う。
- RQRCode: RubyでQR画像を生成するライブラリ。
- data URL: 画像データを文字列で埋め込む形式。
- UserAgent: ブラウザや端末の種類を示す文字列。
- VAPID: Web Push用の公開鍵/秘密鍵の仕組み。
- Service Worker: ブラウザで通知を受け取るための常駐スクリプト。
- BOM: CSVの文字コードを示す先頭の目印。
- SSO: 一度のログインで複数サービスに入れる仕組み。
- OIDC/SAML: SSOで使う認証プロトコル。
- API: 外部システムとデータ連携する窓口。
- MVC: Model/View/Controllerに分ける設計。
- Service Object: ビジネスロジックをクラスに分離する設計。
- Rails.cache: キャッシュに一時保存する仕組み。

## 学生向け（33問）
※専門用語は「用語注釈（簡易）」を参照
1. Q: RoR出席システムって何？
   A: QRで出席・退室・履歴・申請を簡単にする学内向けの出席管理システムです。
2. Q: どこからログインする？
   A: `/login` でメールアドレスとパスワードを入力します。
3. Q: 学生アカウントはどうやってもらう？
   A: 学校または管理者が発行します。
4. Q: パスワードを忘れたら？
   A: 管理者に再設定を依頼してください。
5. Q: 出席はどう取る？
   A: 教員が表示したQRをスキャンします。
6. Q: いつのQRでもいい？
   A: 当日かつ有効期限内のQRだけが有効です。
7. Q: 出席扱いになる条件は？
   A: 教員が発行したQRをスキャンした記録が「出席」になります。
8. Q: 授業開始から20分過ぎたら？
   A: 出席登録できず欠席扱いになります。
9. Q: 遅刻はどうなる？
   A: 遅刻申請が承認された場合に遅刻として反映されます。
10. Q: 退室はどう記録される？
    A: 同じ授業のQRを2回目にスキャンすると退室が記録されます。
11. Q: 早退判定は？
    A: 滞在時間が授業の80%未満だと早退になります。
12. Q: 出席履歴はどこで見る？
    A: `/history` で確認できます。
13. Q: 出席履歴を出力できる？
    A: CSVでダウンロードできます。
14. Q: 欠席/遅刻/公欠の申請はどこ？
    A: `/attendance_requests` から送信します。
15. Q: 申請はいつ反映される？
    A: 教員が承認した時点で出席に反映されます。
16. Q: 申請の進捗はどこで見る？
    A: 申請履歴のステータスで確認できます。
17. Q: 通知はどこで見る？
    A: `/notifications` に一覧で表示されます。
18. Q: メール/LINE/Push通知は使える？
    A: 連携設定が有効なら通知を受け取れます。
19. Q: カメラが使えないときは？
    A: 手入力フォームにQR文字列を貼り付けて送信します。
20. Q: 対応ブラウザは？
    A: Chrome/EdgeなどのChromium系推奨、iOS Safari 16+はフォールバック対応です。
21. Q: QRが古いと言われたら？
    A: 教員に再表示を依頼してください。
22. Q: 履修していないクラスを読んだら？
    A: 未履修エラーになり出席登録できません。
23. Q: 休講日にスキャンしたら？
    A: 休講エラーが表示されます。
24. Q: 出席確定済みの授業は？
    A: 登録できずエラー表示になります。
25. Q: スキャンを連打したら？
    A: レート制限で一時的にブロックされます。
26. Q: 端末登録って何？
    A: 公認端末のみスキャン許可にする運用です。
27. Q: 端末登録はどこ？
    A: プロフィール画面の端末登録から行います。
28. Q: 通知設定はどこ？
    A: プロフィールの通知設定で変更できます。
29. Q: LINE IDはどこで設定？
    A: プロフィールのLINE欄に登録します。
30. Q: Push通知はどう許可する？
    A: ブラウザの許可とプロフィールのON設定が必要です。
31. Q: 「要注意」とは？
    A: 欠席合計が3回以上、または出席率70%未満の状態です。
32. Q: 出席率の計算は？
    A: (出席+遅刻+公欠) / 予定回数 × 100 です。
33. Q: 個人情報の扱いは？
    A: `/data-policy` に保存期間と利用目的を明記しています。

## 教員向け（33問）
※専門用語は「用語注釈（簡易）」を参照
1. Q: 教員ができることは？
   A: クラス管理、QR発行、出席管理、申請承認、レポート、監査ログ確認です。
2. Q: クラスはどこで作成する？
   A: `/school_classes` の「新規クラス」から作成します。
3. Q: 時限と曜日の設定は？
   A: クラス作成画面で時限と曜日を設定します。
4. Q: 休講/補講の設定は？
   A: クラス詳細の「特別日程」で設定します。
5. Q: 名簿取り込みは？
   A: クラス詳細のCSVインポートから行います。
6. Q: 新規学生の作成は？
   A: 管理者のみ可能で、教員は既存学生の更新のみです。
7. Q: QR発行はどこ？
   A: `/generate-qr` から発行します。
8. Q: QRは自動更新される？
   A: 約60秒ごとに自動更新され、古いQRは無効になります。
9. Q: QRの有効期限は？
   A: 5分です。
10. Q: スキャン結果はどこで確認？
    A: 出席管理画面にリアルタイムで反映されます。
11. Q: 退室の記録は？
    A: 学生が同じQRを2回目にスキャンすると退室になります。
12. Q: 出席を手動で修正するには？
    A: 出席管理の編集で変更し、理由を入力して保存します。
13. Q: 教員の修正は即時反映？
    A: 管理者承認が必要なため、操作申請になります。
14. Q: 出席申請の承認は？
    A: `/attendance_requests` で承認/却下できます。
15. Q: 一括承認はできる？
    A: 申請一覧の一括処理で可能です。
16. Q: 出席確定はどうする？
    A: 出席管理から確定を実行し、教員は承認申請になります。
17. Q: 確定解除はどうする？
    A: 管理者のみ解除でき、教員は申請します。
18. Q: 自動欠席確定は？
    A: 授業締切後に未登録者を欠席として確定します。
19. Q: 出席ポリシーで変えられる項目は？
    A: レート制限、最低出席率、警告閾値、IP/端末制限などです。
20. Q: 遅刻/締切の扱いは？
    A: QRスキャンは出席扱い、20分後は登録不可。遅刻は申請/手動で反映します。
21. Q: 開始前のスキャンは？
    A: 許可設定で開始前チェックインを制御できます。
22. Q: IP/端末制限は？
    A: 許可IPや端末キーワードを設定できます。
23. Q: 公認端末運用は？
    A: 公認端末のみ許可する設定を有効化できます。
24. Q: 不正検知アラートは？
    A: 失敗多発、同一IP集中、QR共有疑いで通知されます。
25. Q: スキャンログはどこ？
    A: `/scan-logs` で確認できます。
26. Q: 出席変更ログはどこ？
    A: `/attendance-logs` で確認できます。
27. Q: CSVエクスポートは？
    A: 出席管理画面で期間を指定して出力します。
28. Q: CSVインポートは？
    A: 教員は申請、管理者が承認して反映します。
29. Q: レポートはどこ？
    A: `/reports` で期間を指定して確認します。
30. Q: 期末レポートは？
    A: PDF/CSVで出力できます。
31. Q: 通知設定は？
    A: プロフィールでメール/LINE/PushのON/OFFを設定します。
32. Q: 学生がQRを読めない場合は？
    A: 手入力で対応するか、申請で補正します。
33. Q: クラスの削除は？
    A: 管理者のみ削除できます。

## 観覧エンジニア向け（33問）
※専門用語は「用語注釈（簡易）」を参照
1. Q: 技術スタックは？
   A: Ruby on Rails 8、Hotwire、Tailwind CSS、PostgreSQLです。
2. Q: アーキテクチャは？
   A: MVC + Service Object で責務分離しています。
3. Q: 認証方式は？
   A: `has_secure_password` とセッション認証です。
4. Q: 認可方式は？
   A: ロール + 権限テーブルで `require_role!` / `require_permission!` を適用します。
5. Q: QRトークンはどう生成？
   A: `AttendanceToken` が MessageVerifier で署名します。
6. Q: トークンのペイロードは？
   A: class_id / teacher_id / session_id / date / exp です。
7. Q: トークンの有効期限は？
   A: 5分です。
8. Q: 再発行時の扱いは？
   A: 既存 `QrSession` を失効し最新のみ有効にします。
9. Q: QR画像の生成は？
   A: RQRCodeでPNGを生成しdata URLで表示します。
10. Q: QRの自動更新は？
    A: StimulusがJSONを取得して約60秒ごとに更新します。
11. Q: スキャンログの設計は？
    A: `QrScanEvent` に結果・IP・UserAgent・時刻を保存します。
12. Q: token_digestとは？
    A: トークン文字列をSHA256でハッシュ化した値です。
13. Q: レート制限は？
    A: Rails.cacheで分単位のカウントを保持し制御します。
14. Q: 不正検知は？
    A: 失敗多発/IP集中/トークン共有を `QrFraudDetector` で検知します。
15. Q: 出席ポリシーの中心は？
    A: `AttendancePolicy` にしきい値と判定ロジックを集約しています。
16. Q: 早退判定は？
    A: 最低出席率に基づく滞在分数不足で判定します。
17. Q: 出席レコードの一意性は？
    A: 学生×クラス×日付で一意制約です。
18. Q: 監査ログは？
    A: `AttendanceChange` に理由必須で記録します。
19. Q: 出席申請のフローは？
    A: pending → approved/rejected で承認時に出席へ反映します。
20. Q: 操作申請の対象は？
    A: 出席修正/確定/解除/CSV反映を管理者承認で実行します。
21. Q: 自動欠席確定は？
    A: `AttendanceFinalizer` が締切後に欠席を作成しロックします。
22. Q: 授業回の生成は？
    A: `ClassSessionResolver` がスケジュールと特別日程から生成します。
23. Q: CSVインポートは？
    A: BOM除去とステータス正規化を行い一括反映します。
24. Q: 名簿CSVの権限は？
    A: 管理者は新規作成、教員は既存更新のみです。
25. Q: レポート集計は？
    A: `ReportsController` と `TermReportBuilder` が集計します。
26. Q: PDF生成は？
    A: Prawnで期末レポートを生成します。
27. Q: 通知は？
    A: `Notification` を作成し、設定があればメール/LINE/Pushへ配信します。
28. Q: Push通知は？
    A: Web Push + VAPID鍵で配信し、Service Workerで受信します。
29. Q: API連携は？
    A: APIキー + スコープで `/api/v1` を提供します。
30. Q: DB構成は？
    A: users, school_classes, attendance_records, qr_sessions などを中心にFKで連携します。
31. Q: テストは？
    A: Minitestのモデル/サービスとCapybaraのE2Eを用意しています。
32. Q: デプロイは？
    A: Render想定で `bin/render-build.sh` と assets:precompile を実行します。
33. Q: 保守性の工夫は？
    A: しきい値と判定をポリシーに集約し、共通化でバグを抑えています。
