# デモシナリオ

## 事前準備
1. `bin/rails db:setup`
2. `bin/rails demo:seed`

### Render DBの内容をデモとして使う場合
- `DEMO_SOURCE_DATABASE_URL` を指定して同期します。
  - 例: `DEMO_SOURCE_DATABASE_URL=... bin/rails demo:sync`
- 同期は現在のDBを上書きするため、デモ用DBでのみ実行してください。

## デモ用アカウント
- 管理者: `admin@example.com` / `password`
- 教員: `teacher@example.com` / `password`
- 学生: `student@example.com` / `password`

※ `DEMO_SOURCE_DATABASE_URL` で同期した場合は、Render側のユーザー情報に依存します。

## 1分デモ台本
- 0:00 教員ログイン → 「今日の授業」からQR発行
- 0:10 学生ログイン → QRスキャンで出席登録
- 0:25 教員で出席申請を承認
- 0:40 レポートで出席率と推移を表示
- 0:55 位置情報はOIC校内(半径50m)固定と説明

## デモ手順
1. 教員でログイン → 「QRコード生成」から授業を選択しQRを表示
2. 学生でログイン → 「QRコードスキャン」で入室登録
3. 同じ学生で再度スキャン → 退室登録(滞在時間/早退判定を確認)
4. 学生が「出席申請」を送信 → 教員が承認/却下
5. 教員が「出席確認」で出席を確定 → 自動欠席確定と通知を確認
6. 「レポート」で週次/日次推移と期末レポート(PDF/CSV)を確認
7. 管理者でログイン → 操作申請を確認
8. 位置情報は OIC 校内(半径50m)のみ有効なため、校外想定の端末はエラー表示を確認

## 全機能デモ順序（展示用）
### 0. 事前準備
1. `bin/rails db:setup`
2. `bin/rails demo:seed`

### 1. ログイン画面（全員共通）
1. アカウントタイプ切り替え、パスワード表示/非表示の確認
2. デモ入力ボタンでメール/パスワード自動入力
3. 利用規約/プライバシー/データ保持ページの遷移確認

### 2. 教員フロー（授業運用の中核）
1. 教員でログイン → ダッシュボードの主要カード/通知バッジを確認
2. クラス管理で「新規クラス作成」
   - 通常: 曜日/時限/頻度の指定
   - デモ用: 時限を使わず開始/終了時刻を指定
3. クラス詳細で履修者を手動追加（学生ID/メール）
4. 名簿CSVインポート（既存学生のみ）で履修を一括追加
5. 特別日程（休講/補講/時間変更）の追加と一覧反映
6. QR生成でクラスを選択 → QR表示/期限/自動更新/ダウンロードを確認

### 3. 学生フロー（QR出席と履歴）
1. 学生でログイン → ダッシュボード確認
2. QRスキャン画面でカメラ開始（不可なら手入力）
3. 正常スキャンで入室登録 → 同一授業回の再スキャンで退室登録
4. 出席履歴で当日ステータス/滞在時間/理由を確認
5. 出席履歴CSV/PDFを期間指定で出力
6. 出席申請（欠席/遅刻/公欠）を送信

### 4. 教員フロー（承認・出席管理）
1. 出席申請一覧で承認/却下（必要なら一括処理）
2. 出席管理でクラス/日付を選択 → 一覧表示
3. 出席修正（理由必須） → 教員は操作申請として登録される
4. CSVインポート/エクスポートの動作確認
5. 出席ポリシー（遅刻/締切/警告値）の更新
6. 出席確定/解除の申請（教員は操作申請）

### 5. 管理者フロー（承認・管理）
1. 管理者でログイン → 管理ダッシュボード確認
2. ユーザー管理: 新規作成/編集/削除（最後の管理者は削除不可）
3. 権限管理: 役割/権限の更新
4. 操作申請の承認/却下 → 出席修正/確定/解除が反映
5. スキャンログ/出席変更ログの検索・CSV出力

### 6. レポート/通知/プロフィール
1. レポートで週次/日次推移・要注意者を表示
2. 期末レポートPDF/CSVの出力
3. 通知一覧を確認 → 個別既読/一括既読
4. プロフィール更新/パスワード変更/Push購読

## 短縮版デモ（3分）
1. 教員ログイン → 「今日の授業」からQR発行
2. 学生ログイン → QRスキャンで入室 → もう一度スキャンで退室
3. 教員で出席申請を承認
4. レポートで出席率推移を表示
5. 管理者で操作申請の承認を確認（承認画面だけ提示）

## 短縮版デモ（5分）
1. 教員ログイン → クラス詳細 → 名簿CSV取り込み（結果表示まで）
2. QR生成 → 学生スキャン（入室/退室）→ 学生履歴で反映確認
3. 出席申請 → 教員が承認
4. 出席管理で修正理由を付けて更新 → 操作申請が作成されたことを確認
5. 管理者で操作申請の承認 → 出席変更ログを確認
6. レポートで週次推移と期末レポート出力を提示

## デモ時のUIポイント
- ボタンは短い動詞で統一（ログイン/保存/戻る）。長い説明はヘルプを参照。
- ドロワーとTurboで画面遷移を減らし、更新後は一覧が即時で置き換わります。
- QRスキャンは成功チェックアニメと短いエラーメッセージ、カメラ不可時の手入力導線を必ず案内。
- CSV/PDFはTurbo無効化で確実にダウンロード、フィルタは「前回条件」復元リンク付き。
## リセット
- `bin/rails demo:reset` でデモデータを削除できます。
