<%# 学生用Bottom Navigation (SP専用: 640px以下で表示) %>
<%# NewUI.md 5.1: ダッシュボード/QRコードスキャン/出席履歴/通知/プロフィール %>
<nav class="bottom-nav sm:hidden" aria-label="メインナビゲーション">
  <div class="bottom-nav-container">
    <%# ダッシュボード %>
    <%= link_to root_path, class: "bottom-nav-link #{request.path == root_path ? 'active' : ''}", "aria-current": (request.path == root_path ? 'page' : nil) do %>
      <svg class="bottom-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z" stroke-linecap="round" stroke-linejoin="round"/>
        <polyline points="9,22 9,12 15,12 15,22" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="bottom-nav-label">ダッシュボード</span>
    <% end %>

    <%# QRスキャン %>
    <%= link_to scan_path, class: "bottom-nav-link #{request.path == scan_path ? 'active' : ''}", "aria-current": (request.path == scan_path ? 'page' : nil) do %>
      <svg class="bottom-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="3" width="6" height="6"/>
        <rect x="15" y="3" width="6" height="6"/>
        <rect x="3" y="15" width="6" height="6"/>
        <path d="M15 15h6v6h-6z"/>
        <path d="M11 11h2v2h-2z"/>
      </svg>
      <span class="bottom-nav-label">QRコードスキャン</span>
    <% end %>

    <%# 出席履歴 %>
    <%= link_to history_path, class: "bottom-nav-link #{request.path.start_with?(history_path) ? 'active' : ''}", "aria-current": (request.path.start_with?(history_path) ? 'page' : nil) do %>
      <svg class="bottom-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
        <line x1="8" y1="2" x2="8" y2="6"/>
        <line x1="16" y1="2" x2="16" y2="6"/>
        <line x1="3" y1="10" x2="21" y2="10"/>
      </svg>
      <span class="bottom-nav-label">出席履歴</span>
    <% end %>

    <%# 通知 %>
    <%= link_to notifications_path, class: "bottom-nav-link #{request.path.start_with?(notifications_path) ? 'active' : ''} relative", "aria-current": (request.path.start_with?(notifications_path) ? 'page' : nil) do %>
      <div class="relative">
        <svg class="bottom-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <% if @unread_notifications_count.to_i > 0 %>
          <span class="bottom-nav-badge" aria-label="未読<%= @unread_notifications_count %>件">
            <%= @unread_notifications_count > 9 ? '9+' : @unread_notifications_count %>
          </span>
        <% end %>
      </div>
      <span class="bottom-nav-label">通知</span>
    <% end %>

    <%# プロフィール %>
    <%= link_to profile_path, class: "bottom-nav-link #{request.path.start_with?(profile_path) ? 'active' : ''}", "aria-current": (request.path.start_with?(profile_path) ? 'page' : nil) do %>
      <svg class="bottom-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2" stroke-linecap="round" stroke-linejoin="round"/>
        <circle cx="12" cy="7" r="4" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="bottom-nav-label">プロフィール</span>
    <% end %>
  </div>
</nav>
