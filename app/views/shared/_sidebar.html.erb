<%# AdminKit風サイドバー: 濃紺/ダークテーマ、セクション見出し、アクティブ時青系ハイライト＋左インジケータ %>
<aside
  data-sidebar-target="sidebar"
  class="sidebar fixed top-[var(--app-header-height)] bottom-0 left-0 lg:top-0 z-30 transform transition-transform duration-300 ease-in-out -translate-x-full lg:translate-x-0 overflow-y-auto"
>
  <div class="h-full min-h-full flex flex-col">
    <%# サイドバーヘッダー %>
    <div class="sidebar-header">
      <div class="sidebar-brand">
        <div class="sidebar-brand-mark">R</div>
        <div>
          <h2 class="sidebar-header-title">RoR出席管理システム</h2>
          <div class="sidebar-header-subtitle">
            <%= current_user.admin? ? "管理者メニュー" : (current_user.teacher? ? "教員メニュー" : "学生メニュー") %>
          </div>
        </div>
      </div>
    </div>

    <%# ナビゲーション %>
    <nav class="flex-1 py-4 px-3">
      <% if current_user.admin? %>
        <%# 管理者ナビゲーション %>
        <div class="sidebar-section">
          <div class="sidebar-section-title">管理</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("管理者ダッシュボード", admin_path, "shield") %>
          </ul>
        </div>

        <div class="sidebar-section">
          <div class="sidebar-section-title">ユーザーと権限</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("ユーザー管理", admin_users_path, "users") %>
            <%= sidebar_link("ロール/権限", admin_roles_path, "key") %>
            <%= sidebar_link("操作申請", admin_operation_requests_path, "clipboard-check", @pending_operation_requests_count) %>
          </ul>
        </div>

        <div class="sidebar-section">
          <div class="sidebar-section-title">監査</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("QRスキャンログ", scan_logs_path, "list") %>
            <%= sidebar_link("出席変更ログ", attendance_logs_path, "history") %>
          </ul>
        </div>

        <div class="sidebar-section">
          <div class="sidebar-section-title">教員機能</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("ダッシュボード", root_path, "home") %>
            <%= sidebar_link("クラス管理", school_classes_path, "class") %>
            <%= sidebar_link("出席確認", attendance_path, "clipboard") %>
            <%= sidebar_link("出席申請", attendance_requests_path, "clipboard-check", @pending_requests_count) %>
            <%= sidebar_link("QRコード発行", generate_qr_path, "qr") %>
            <%= sidebar_link("レポート", reports_path, "report") %>
          </ul>
        </div>

        <div class="sidebar-section">
          <div class="sidebar-section-title">設定</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("プロフィール", profile_path, "user") %>
          </ul>
        </div>

      <% elsif current_user.staff? %>
        <%# 教員/スタッフナビゲーション %>
        <div class="sidebar-section">
          <div class="sidebar-section-title">ダッシュボード</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("ダッシュボード", root_path, "home") %>
          </ul>
        </div>

        <div class="sidebar-section">
          <div class="sidebar-section-title">クラス</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("クラス管理", school_classes_path, "class") %>
          </ul>
        </div>

        <div class="sidebar-section">
          <div class="sidebar-section-title">出席</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("出席確認", attendance_path, "clipboard") %>
            <%= sidebar_link("出席申請", attendance_requests_path, "clipboard-check", @pending_requests_count) %>
            <%= sidebar_link("出席変更ログ", attendance_logs_path, "history") %>
          </ul>
        </div>

        <div class="sidebar-section">
          <div class="sidebar-section-title">QR</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("QRコード発行", generate_qr_path, "qr") %>
            <%= sidebar_link("QRスキャンログ", scan_logs_path, "list") %>
          </ul>
        </div>

        <div class="sidebar-section">
          <div class="sidebar-section-title">レポート</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("レポート", reports_path, "report") %>
          </ul>
        </div>

        <div class="sidebar-section">
          <div class="sidebar-section-title">設定</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("プロフィール", profile_path, "user") %>
            <%= sidebar_link("通知設定", notifications_path, "bell") %>
          </ul>
        </div>

      <% else %>
        <%# 学生ナビゲーション %>
        <div class="sidebar-section">
          <div class="sidebar-section-title">学生</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("ダッシュボード", root_path, "home") %>
            <%= sidebar_link("QRスキャン", scan_path, "qr") %>
            <%= sidebar_link("出席履歴", history_path, "calendar") %>
            <%= sidebar_link("出席申請", attendance_requests_path, "clipboard-check", @pending_requests_count) %>
            <%= sidebar_link("通知", notifications_path, "bell") %>
          </ul>
        </div>

        <div class="sidebar-section">
          <div class="sidebar-section-title">アカウント</div>
          <ul class="sidebar-nav">
            <%= sidebar_link("プロフィール", profile_path, "user") %>
          </ul>
        </div>
      <% end %>

    </nav>
  </div>
</aside>
