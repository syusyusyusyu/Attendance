# 教員向け運用ガイド

## 1. 授業回の自動生成
- クラス作成時に「曜日/開始/終了」を設定すると、該当日の授業回が自動生成されます。
- 出席確認画面を開く/CSV入出力を行うタイミングで授業回が確定します。
- 休講/補講はクラス詳細の「特別日程」から日付単位で設定します。

## 2. 出席確定（授業締切基準）
- 出席確定は「授業開始 + 締切(分)」以降に実行できます。
- 出席確認画面で「出席を確定」を押すと、未登録者は自動で欠席として確定されます。
- 確定後は通常の手動修正は不可です（管理者のみ解除可能）。

## 3. 出席確定の解除（再開）
- 管理者のみ「確定解除」を実行できます。
- 解除後は再度手動修正/再確定が可能です。

## 4. 出席変更ログ（監査）
- 手動修正・CSV・自動確定はすべて監査ログに記録されます。
- 変更理由は必須です（理由なしの変更は保存されません）。
- `/attendance-logs` で一覧確認・期間指定・CSV出力ができます。

## 5. QR運用と不正対策
- QRは自動ローテーション（60秒）で更新されます。
- 出席ポリシーで「許可IP」「許可端末キーワード」「分間スキャン上限」を設定できます。
- 不正検知アラート:
  - 失敗スキャンの同時多発
  - 同一IPからの集中アクセス
  - IP/端末制限に該当するアクセス
  - 同一QRの共有利用
- 不正検知は通知に表示され、スキャンログへの導線が付きます。

## 6. 定期運用（自動確定）
- 定期確定は `bin/rails attendance:finalize` をスケジューラで実行します。
- Render では Cron Job を使用して毎日定時に実行する運用を推奨します。

## 7. デモ運用
- `bin/rails demo:seed` でデモ用データを一括生成します。
- `bin/rails demo:reset` でデモデータを削除します。
