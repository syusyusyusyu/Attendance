# 教員向け運用ガイド

## 1. 授業回の自動生成と特別日程
- クラス作成時に「曜日/時限/開始-終了」を設定すると授業回が自動生成されます。
- 休講/補講はクラス詳細の「特別日程」から日付単位で設定します。
- 出席確認画面を開く/CSV入出力を行うタイミングで授業回が確定します。

## 2. 出席確定(授業締切基準)
- 授業開始 + 締切分数を過ぎると「出席確定」が可能になります。
- 確定時、未入力の学生は自動的に欠席として確定されます。
- 確定後の修正は管理者承認が必要です。

## 3. 出席修正と承認フロー
- 教員は出席修正/確定解除/CSV反映を行うと「操作申請」として管理者に届きます。
- 管理者が承認すると処理が実行され、監査ログに記録されます。

## 4. 監査ログ運用
- 変更理由は必須です(理由なしは保存不可)。
- `/attendance-logs` で検索、条件保存、CSV出力が可能です。
- `/scan-logs` でQRスキャンの成功/失敗、端末/IPを確認できます。

## 5. QR運用と不正対策
- QRは自動ローテーションで更新されます。
- 出席ポリシーで「許可IP」「端末要件」「レート制限」を設定可能です。
- 不正検知アラートは通知に表示され、スキャンログへ誘導します。

## 6. 定期運用(自動確定)
- `bin/rails attendance:finalize` をCronで定期実行します。
- RenderではCron Jobで毎日定時の実行を推奨します。

## 7. 端末登録
- 学生/教員はプロフィールから端末名を編集・承認申請できます。
- 管理者が承認した端末のみスキャン許可にする運用が可能です。

## 8. 管理者ダッシュボード
- `/admin` から承認申請/端末承認/ユーザー/権限/監査/SSO/APIを統合管理できます。
- 操作申請は「承認/却下」の履歴が保存されます。

## 9. デモ運用
- `bin/rails demo:seed` でデモデータ作成
- `bin/rails demo:reset` でデモデータ削除
- 詳細は `DEMO.md` を参照
